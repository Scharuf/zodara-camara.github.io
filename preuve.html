<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <title>Galerie des preuves</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{ --bg:#f5f7fb; --card:#fff; --text:#1d2125; --muted:#6c757d; --border:#e9edf3; --shadow:0 2px 12px rgba(16,24,40,.06) }
    body{ margin:0; padding:24px; font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; background:var(--bg); color:var(--text) }
    .container{ max-width:1100px; margin:0 auto }
    a.btn{ display:inline-block; padding:8px 12px; border-radius:10px; text-decoration:none; background:#0d6efd; color:#fff; font-weight:700 }
    .grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:14px; margin-top:16px }
    @media (max-width:1000px){ .grid{ grid-template-columns:1fr 1fr } }
    @media (max-width:650px){ .grid{ grid-template-columns:1fr } }
    .card{ background:var(--card); border:1px solid var(--border); border-radius:12px; box-shadow:var(--shadow); overflow:hidden }
    .card img{ width:100%; height:260px; object-fit:cover; display:block }
    .meta{ padding:10px 12px; font-size:13px; color:var(--muted) }
    .empty{ color:var(--muted); padding:24px; background:var(--card); border:1px solid var(--border); border-radius:12px }
  </style>
</head>
<body>
  <div class="container">
    <div style="display:flex; justify-content:space-between; align-items:center">
      <h2 style="margin:0">Galerie des preuves</h2>
      <a class="btn" href="/">← Retour au dashboard</a>
    </div>

    {% if not rows %}
      <div class="empty" style="margin-top:16px">Aucune preuve trouvée.</div>
    {% else %}
      <div class="grid">
        {% for r in rows %}
          <div class="card">
            {% if image_key and r[image_key] %}
              <img src="{{ r[image_key] }}" alt="Preuve">
            {% else %}
              <img src="https://via.placeholder.com/800x500?text=Preuve" alt="Preuve">
            {% endif %}
            <div class="meta">
              {% if r.get('id_sae') %} SAÉ #{{ r['id_sae'] }} &nbsp;•&nbsp; {% endif %}
              ID: {{ r.get('id') or r.get('id_preuve') or loop.index }}
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</body>
</html>
